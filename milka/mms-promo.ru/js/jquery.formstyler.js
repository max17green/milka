!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){"use strict";e.fn.styler=function(t){var s=e.extend({wrapper:"form",idSuffix:"-styler",filePlaceholder:"Файл не выбран",fileBrowse:"Обзор...",selectPlaceholder:"Выберите...",selectSearch:!1,selectSearchLimit:10,selectSearchNotFound:"Совпадений не найдено",selectSearchPlaceholder:"Поиск...",selectVisibleOptions:0,singleSelectzIndex:"100",selectSmartPositioning:!0,onSelectOpened:function(){},onSelectClosed:function(){},onFormStyled:function(){}},t);return this.each(function(){function t(){var e="",t="",i="",o="";void 0!==l.attr("id")&&""!==l.attr("id")&&(e=' id="'+l.attr("id")+s.idSuffix+'"'),void 0!==l.attr("title")&&""!==l.attr("title")&&(t=' title="'+l.attr("title")+'"'),void 0!==l.attr("class")&&""!==l.attr("class")&&(i=" "+l.attr("class"));var a=l.data();for(var d in a)""!==a[d]&&(o+=" data-"+d+'="'+a[d]+'"');e+=o,this.id=e,this.title=t,this.classes=i}var l=e(this),i=!(!navigator.userAgent.match(/(iPad|iPhone|iPod)/i)||navigator.userAgent.match(/(Windows\sPhone)/i)),o=!(!navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/(Windows\sPhone)/i));l.is(":checkbox")?l.each(function(){if(l.parent("div.jq-checkbox").length<1){var s=function(){var s=new t,i=e("<div"+s.id+' class="jq-checkbox'+s.classes+'"'+s.title+'><div class="jq-checkbox__div"></div></div>');l.css({position:"absolute",zIndex:"-1",opacity:0,margin:0,padding:0}).after(i).prependTo(i),i.attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none",display:"inline-block",position:"relative",overflow:"hidden"}),l.is(":checked")&&i.addClass("checked"),l.is(":disabled")&&i.addClass("disabled"),i.on("click.styler",function(){return!i.is(".disabled")&&(l.is(":checked")?(l.prop("checked",!1),i.removeClass("checked")):(l.prop("checked",!0),i.addClass("checked")),l.change(),!1)}),l.closest("label").add('label[for="'+l.attr("id")+'"]').click(function(t){e(t.target).is("a")||(i.click(),t.preventDefault())}),l.on("change.styler",function(){l.is(":checked")?i.addClass("checked"):i.removeClass("checked")}).on("keydown.styler",function(e){32==e.which&&i.click()}).on("focus.styler",function(){i.is(".disabled")||i.addClass("focused")}).on("blur.styler",function(){i.removeClass("focused")})};s(),l.on("refresh",function(){l.off(".styler").parent().before(l).remove(),s()})}}):l.is(":radio")?l.each(function(){if(l.parent("div.jq-radio").length<1){var i=function(){var i=new t,o=e("<div"+i.id+' class="jq-radio'+i.classes+'"'+i.title+'><div class="jq-radio__div"></div></div>');l.css({position:"absolute",zIndex:"-1",opacity:0,margin:0,padding:0}).after(o).prependTo(o),o.attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none",display:"inline-block",position:"relative"}),l.is(":checked")&&o.addClass("checked"),l.is(":disabled")&&o.addClass("disabled"),o.on("click.styler",function(){return!o.is(".disabled")&&(o.closest(s.wrapper).find('input[name="'+l.attr("name")+'"]').prop("checked",!1).parent().removeClass("checked"),l.prop("checked",!0).parent().addClass("checked"),l.change(),!1)}),l.closest("label").add('label[for="'+l.attr("id")+'"]').click(function(t){e(t.target).is("a")||(o.click(),t.preventDefault())}),l.on("change.styler",function(){l.parent().addClass("checked")}).on("focus.styler",function(){o.is(".disabled")||o.addClass("focused")}).on("blur.styler",function(){o.removeClass("focused")})};i(),l.on("refresh",function(){l.off(".styler").parent().before(l).remove(),i()})}}):l.is(":file")?l.css({position:"absolute",top:0,right:0,width:"100%",height:"100%",opacity:0,margin:0,padding:0}).each(function(){if(l.parent("div.jq-file").length<1){var i=function(){var i=new t,o=l.data("placeholder");void 0===o&&(o=s.filePlaceholder);var a=l.data("browse");void 0!==a&&""!==a||(a=s.fileBrowse);var d=e("<div"+i.id+' class="jq-file'+i.classes+'"'+i.title+' style="display: inline-block; position: relative; overflow: hidden"></div>'),c=e('<div class="jq-file__name">'+o+"</div>").appendTo(d);e('<div class="jq-file__browse">'+a+"</div>").appendTo(d),l.after(d),d.append(l),l.is(":disabled")&&d.addClass("disabled"),l.on("change.styler",function(){var e=l.val();if(l.is("[multiple]")){e="";for(var t=l[0].files,s=0;s<t.length;s++)e+=(s>0?", ":"")+t[s].name}c.text(e.replace(/.+[\\\/]/,"")),""===e?(c.text(o),d.removeClass("changed")):d.addClass("changed")}).on("focus.styler",function(){d.addClass("focused")}).on("blur.styler",function(){d.removeClass("focused")}).on("click.styler",function(){d.removeClass("focused")})};i(),l.on("refresh",function(){l.off(".styler").parent().before(l).remove(),i()})}}):l.is("select")?l.each(function(){if(l.parent("div.jqselect").length<1){var a=function(){function a(t){t.off("mousewheel DOMMouseScroll").on("mousewheel DOMMouseScroll",function(t){var s=null;"mousewheel"==t.type?s=-1*t.originalEvent.wheelDelta:"DOMMouseScroll"==t.type&&(s=40*t.originalEvent.detail),s&&(t.stopPropagation(),t.preventDefault(),e(this).scrollTop(s+e(this).scrollTop()))})}function d(){for(var e=0,t=c.length;e<t;e++){var s="",l="",i="",o="",a="",d="",r="";c.eq(e).prop("selected")&&(l="selected sel"),c.eq(e).is(":disabled")&&(l="disabled"),c.eq(e).is(":selected:disabled")&&(l="selected sel disabled"),void 0!==c.eq(e).attr("class")&&(a=" "+c.eq(e).attr("class"),r=' data-jqfs-class="'+c.eq(e).attr("class")+'"');var h=c.eq(e).data();for(var f in h)""!==h[f]&&(o+=" data-"+f+'="'+h[f]+'"');l+a!==""&&(i=' class="'+l+a+'"'),s="<li"+r+o+i+">"+c.eq(e).html()+"</li>",c.eq(e).parent().is("optgroup")&&(void 0!==c.eq(e).parent().attr("class")&&(d=" "+c.eq(e).parent().attr("class")),s="<li"+r+o+' class="'+l+a+" option"+d+'">'+c.eq(e).html()+"</li>",c.eq(e).is(":first-child")&&(s='<li class="optgroup'+d+'">'+c.eq(e).parent().attr("label")+"</li>"+s)),n+=s}}var c=e("option",l),n="";if(l.is("[multiple]")){if(o||i)return;!function(){var s=new t,i=e("<div"+s.id+' class="jq-select-multiple jqselect'+s.classes+'"'+s.title+' style="display: inline-block; position: relative"></div>');l.css({margin:0,padding:0}).after(i),d(),i.append("<ul>"+n+"</ul>");var o=e("ul",i).css({position:"relative","overflow-x":"hidden","-webkit-overflow-scrolling":"touch"}),r=e("li",i).attr("unselectable","on"),h=l.attr("size"),f=o.outerHeight(),p=r.outerHeight();void 0!==h&&h>0?o.css({height:p*h}):o.css({height:4*p}),f>i.height()&&(o.css("overflowY","scroll"),a(o),r.filter(".selected").length&&o.scrollTop(o.scrollTop()+r.filter(".selected").position().top)),l.prependTo(i).css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0}),l.is(":disabled")?(i.addClass("disabled"),c.each(function(){e(this).is(":selected")&&r.eq(e(this).index()).addClass("selected")})):(r.filter(":not(.disabled):not(.optgroup)").click(function(t){l.focus();var s=e(this);if(t.ctrlKey||t.metaKey||s.addClass("selected"),t.shiftKey||s.addClass("first"),t.ctrlKey||t.metaKey||t.shiftKey||s.siblings().removeClass("selected first"),(t.ctrlKey||t.metaKey)&&(s.is(".selected")?s.removeClass("selected first"):s.addClass("selected first"),s.siblings().removeClass("first")),t.shiftKey){var i=!1,o=!1;s.siblings().removeClass("selected").siblings(".first").addClass("selected"),s.prevAll().each(function(){e(this).is(".first")&&(i=!0)}),s.nextAll().each(function(){e(this).is(".first")&&(o=!0)}),i&&s.prevAll().each(function(){if(e(this).is(".selected"))return!1;e(this).not(".disabled, .optgroup").addClass("selected")}),o&&s.nextAll().each(function(){if(e(this).is(".selected"))return!1;e(this).not(".disabled, .optgroup").addClass("selected")}),1==r.filter(".selected").length&&s.addClass("first")}c.prop("selected",!1),r.filter(".selected").each(function(){var t=e(this),s=t.index();t.is(".option")&&(s-=t.prevAll(".optgroup").length),c.eq(s).prop("selected",!0)}),l.change()}),c.each(function(t){e(this).data("optionIndex",t)}),l.on("change.styler",function(){r.removeClass("selected");var t=[];c.filter(":selected").each(function(){t.push(e(this).data("optionIndex"))}),r.not(".optgroup").filter(function(s){return e.inArray(s,t)>-1}).addClass("selected")}).on("focus.styler",function(){i.addClass("focused")}).on("blur.styler",function(){i.removeClass("focused")}),f>i.height()&&l.on("keydown.styler",function(e){38!=e.which&&37!=e.which&&33!=e.which||o.scrollTop(o.scrollTop()+r.filter(".selected").position().top-p),40!=e.which&&39!=e.which&&34!=e.which||o.scrollTop(o.scrollTop()+r.filter(".selected:last").position().top-o.innerHeight()+2*p)}))}()}else!function(){var o=new t,r="",h=l.data("placeholder"),f=l.data("search"),p=l.data("search-limit"),u=l.data("search-not-found"),v=l.data("search-placeholder"),g=l.data("z-index"),b=l.data("smart-positioning");void 0===h&&(h=s.selectPlaceholder),void 0!==f&&""!==f||(f=s.selectSearch),void 0!==p&&""!==p||(p=s.selectSearchLimit),void 0!==u&&""!==u||(u=s.selectSearchNotFound),void 0===v&&(v=s.selectSearchPlaceholder),void 0!==g&&""!==g||(g=s.singleSelectzIndex),void 0!==b&&""!==b||(b=s.selectSmartPositioning);var m=e("<div"+o.id+' class="jq-selectbox jqselect'+o.classes+'" style="display: inline-block; position: relative; z-index:'+g+'"><div class="jq-selectbox__select"'+o.title+' style="position: relative"><div class="jq-selectbox__select-text"></div><div class="jq-selectbox__trigger"><div class="jq-selectbox__trigger-arrow"></div></div></div></div>');l.css({margin:0,padding:0}).after(m).prependTo(m);var w=e("div.jq-selectbox__select",m),C=e("div.jq-selectbox__select-text",m),y=c.filter(":selected");d(),f&&(r='<div class="jq-selectbox__search"><input type="search" autocomplete="off" placeholder="'+v+'"></div><div class="jq-selectbox__not-found">'+u+"</div>");var x=e('<div class="jq-selectbox__dropdown" style="position: absolute">'+r+'<ul style="position: relative; list-style: none; overflow: auto; overflow-x: hidden">'+n+"</ul></div>");m.append(x);var q=e("ul",x),k=e("li",x),j=e("input",x),_=e("div.jq-selectbox__not-found",x).hide();k.length<p&&j.parent().hide(),""===l.val()?C.text(h).addClass("placeholder"):C.text(y.text());var T=0,S=0;k.each(function(){var t=e(this);t.css({display:"inline-block"}),t.innerWidth()>T&&(T=t.innerWidth(),S=t.width()),t.css({display:""})});var P=m.clone().appendTo("body").width("auto"),A=P.find("select").outerWidth();P.remove(),A==m.width()&&C.width(S),T>m.width()&&x.width(T),C.is(".placeholder")&&C.width()>T&&C.width(C.width()),""===c.first().text()&&""!==l.data("placeholder")&&k.first().hide(),l.css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0});var z=m.outerHeight(),H=j.outerHeight(),I=q.css("max-height"),D=k.filter(".selected");D.length<1&&k.first().addClass("selected sel"),void 0===k.data("li-height")&&k.data("li-height",k.outerHeight());var K=x.css("top");if("auto"==x.css("left")&&x.css({left:0}),"auto"==x.css("top")&&x.css({top:z}),x.hide(),D.length&&(c.first().text()!=y.text()&&m.addClass("changed"),m.data("jqfs-class",D.data("jqfs-class")),m.addClass(D.data("jqfs-class"))),l.is(":disabled"))return m.addClass("disabled"),!1;w.click(function(){if(e("div.jq-selectbox").filter(".opened").length&&s.onSelectClosed.call(e("div.jq-selectbox").filter(".opened")),l.focus(),!i){var t=e(window),o=k.data("li-height"),d=m.offset().top,n=t.height()-z-(d-t.scrollTop()),r=l.data("visible-options");void 0!==r&&""!==r||(r=s.selectVisibleOptions);var h=5*o,f=o*r;r>0&&r<6&&(h=f),0===r&&(f="auto");var p=function(){x.height("auto").css({bottom:"auto",top:K});var e=function(){q.css("max-height",Math.floor((n-20-H)/o)*o)};e(),q.css("max-height",f),"none"!=I&&q.css("max-height",I),n<x.outerHeight()+20&&e()};return!0===b||1===b?n>h+H+20?(p(),m.removeClass("dropup").addClass("dropdown")):(function(){x.height("auto").css({top:"auto",bottom:K});var e=function(){q.css("max-height",Math.floor((d-t.scrollTop()-20-H)/o)*o)};e(),q.css("max-height",f),"none"!=I&&q.css("max-height",I),d-t.scrollTop()-20<x.outerHeight()+20&&e()}(),m.removeClass("dropdown").addClass("dropup")):!1!==b&&0!==b||n>h+H+20&&(p(),m.removeClass("dropup").addClass("dropdown")),m.offset().left+x.outerWidth()>t.width()&&x.css({left:"auto",right:0}),e("div.jqselect").css({zIndex:g-1}).removeClass("opened"),m.css({zIndex:g}),x.is(":hidden")?(e("div.jq-selectbox__dropdown:visible").hide(),x.show(),m.addClass("opened focused"),s.onSelectOpened.call(m)):(x.hide(),m.removeClass("opened dropup dropdown"),e("div.jq-selectbox").filter(".opened").length&&s.onSelectClosed.call(m)),j.length&&(j.val("").keyup(),_.hide(),j.keyup(function(){var t=e(this).val();k.each(function(){e(this).html().match(new RegExp(".*?"+t+".*?","i"))?e(this).show():e(this).hide()}),""===c.first().text()&&""!==l.data("placeholder")&&k.first().hide(),k.filter(":visible").length<1?_.show():_.hide()})),k.filter(".selected").length&&(""===l.val()?q.scrollTop(0):(q.innerHeight()/o%2!=0&&(o/=2),q.scrollTop(q.scrollTop()+k.filter(".selected").position().top-q.innerHeight()/2+o))),a(q),!1}}),k.hover(function(){e(this).siblings().removeClass("selected")});var O=k.filter(".selected").text();k.filter(":not(.disabled):not(.optgroup)").click(function(){l.focus();var t=e(this),i=t.text();if(!t.is(".selected")){var o=t.index();o-=t.prevAll(".optgroup").length,t.addClass("selected sel").siblings().removeClass("selected sel"),c.prop("selected",!1).eq(o).prop("selected",!0),O=i,C.text(i),m.data("jqfs-class")&&m.removeClass(m.data("jqfs-class")),m.data("jqfs-class",t.data("jqfs-class")),m.addClass(t.data("jqfs-class")),l.change()}x.hide(),m.removeClass("opened dropup dropdown"),s.onSelectClosed.call(m)}),x.mouseout(function(){e("li.sel",x).addClass("selected")}),l.on("change.styler",function(){C.text(c.filter(":selected").text()).removeClass("placeholder"),k.removeClass("selected sel").not(".optgroup").eq(l[0].selectedIndex).addClass("selected sel"),c.first().text()!=k.filter(".selected").text()?m.addClass("changed"):m.removeClass("changed")}).on("focus.styler",function(){m.addClass("focused"),e("div.jqselect").not(".focused").removeClass("opened dropup dropdown").find("div.jq-selectbox__dropdown").hide()}).on("blur.styler",function(){m.removeClass("focused")}).on("keydown.styler keyup.styler",function(e){var t=k.data("li-height");""===l.val()?C.text(h).addClass("placeholder"):C.text(c.filter(":selected").text()),k.removeClass("selected sel").not(".optgroup").eq(l[0].selectedIndex).addClass("selected sel"),38!=e.which&&37!=e.which&&33!=e.which&&36!=e.which||(""===l.val()?q.scrollTop(0):q.scrollTop(q.scrollTop()+k.filter(".selected").position().top)),40!=e.which&&39!=e.which&&34!=e.which&&35!=e.which||q.scrollTop(q.scrollTop()+k.filter(".selected").position().top-q.innerHeight()+t),13==e.which&&(e.preventDefault(),x.hide(),m.removeClass("opened dropup dropdown"),s.onSelectClosed.call(m))}).on("keydown.styler",function(e){32==e.which&&(e.preventDefault(),w.click())}),e(document).on("click",function(t){e(t.target).parents().hasClass("jq-selectbox")||"OPTION"==t.target.nodeName||(e("div.jq-selectbox").filter(".opened").length&&s.onSelectClosed.call(e("div.jq-selectbox").filter(".opened")),j.length&&j.val("").keyup(),x.hide().find("li.sel").addClass("selected"),m.removeClass("focused opened dropup dropdown"))})}()};a(),l.on("refresh",function(){l.off(".styler").parent().before(l).remove(),a()})}}):l.is(":reset")&&l.on("click",function(){setTimeout(function(){l.closest(s.wrapper).find("input, select").trigger("refresh")},1)})}).promise().done(function(){s.onFormStyled.call()})}});